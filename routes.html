<!DOCTYPE html>
<html lang="en">
 <head>   
    <meta charset	="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name		="description" content="">
    <meta name		="author" content="Xing Yu">

	<meta name="application-name" content="Bus Routes">
	<meta name="apple-mobile-web-app-title" content="Bus Routes">
	<link rel="apple-touch-icon" href="nxy.png">
<link rel="apple-touch-startup-image" href="nxy.png">
<meta name="apple-mob																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		file-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
	<title>Routes</title>
<meta http-equiv="Expires" content="60000" />
 <script src="stops.json" ></script>
 <script src="routes.json" ></script>
<style>row{display:inline!important; border-left="10px!important"; width:40%!important; margin-left:5px!important;}html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0;font-size:2em}mark{color:#000;background:#ff0}}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}a:focus,a:hover{color:#23527c;text-decoration:underline}a:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:768px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}.container-fluid{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.row{display:flex;}table{background-color:transparent}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>tbody>tr>td,.table>tbody>tr>th,.table>tfoot>tr>td,.table>tfoot>tr>th,.table>thead>tr>td,.table>thead>tr>th{padding:2px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>td,.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>td,.table>thead:first-child>tr:first-child>th{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>tbody>tr>td,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>td,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>thead>tr>th{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>tbody>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border:1px solid #ddd}.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border-bottom-width:2px}.table-striped>tbody>tr:nth-of-type(odd){background-color:#f9f9f9}.table-hover>tbody>tr:hover{background-color:#f5f5f5}table col[class*=col-]{position:static;display:table-column;float:none}table td[class*=col-],table th[class*=col-]{position:static;display:table-cell;float:none}.table-responsive{min-height:.01%;overflow-x:auto}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#999;opacity:1}.form-control:-ms-input-placeholder{color:#999}h3{margin:0px!important;}.form-control::-webkit-input-placeholder{color:#999}.form-control::-ms-expand{background-color:transparent;border:0}.form-control[disabled],.form-control[readonly],fieldset[disabled] </style>
</head>
<body>


<form onsubmit="submitbtn()">
<div class="row">
  <input type="text" class="form-control" name="BusNo" id="BusStopNumber" name="keywords" list="BusStopSet">
<datalist id="BusStopSet">
<option selected>Choose your bus stop</option>
</datalist>
<input type="submit" value="Search" class="form-control">  </input></div>
</form>
      <div id = "stage"></div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
var url, id;
var temparray1=[];
var temparray2=[];
var bus, htmlx = '';
function getbuses(){
option="";
var previous="";
for (x=0; x<r.length; x++){
	 if (r[x].ServiceNo==previous){continue;}
else{	 
	 option+='<option value="'+r[x].ServiceNo+'"></option></br>'
	 previous=r[x].ServiceNo;
}
}
console.log(option);
document.getElementById('BusStopSet').innerHTML=option
};
function getroutes(){		 
var i= 0;
var d = new Date();
url = new URL(window.location);
id = url.searchParams.get("BusNo");

var a="";
for(var i = 0; i < r.length; i++) {
    if (id == r[i].ServiceNo) {
        a="<p> Bus "+id+"</p><p>Operator: "+r[i].Operator+"</p><p>Weekdays: "+r[i].WD_FirstBus+"-"+r[i].WD_LastBus+"</p><p>Saturday: "+r[i].SAT_FirstBus+"-"+r[i].SAT_LastBus+"</p><p>Sundays: "+r[i].SUN_FirstBus+"-"+r[i].SUN_LastBus+"</p>";
		break;
    } else {
        a="<p>Please enter a valid Bus Number!</p>"
    }
}


htmlx+=a;
htmlx+= '<div class="table-responsive"> <div class="row"><table class="table"><thead><tr><th>Direction 1</th></tr></thead><tbody>'

for (i=0;i<r.length;i++){
if((r[i].ServiceNo==id) && (r[i].Direction==1)){temparray1.push(r[i].BusStopCode); console.log(r[i].BusStopCode)}
else if((r[i].ServiceNo==id) && (r[i].Direction==2)){temparray2.push(r[i].BusStopCode)}
else{continue}
}
}
function lookup(code){
for (i=0;i<j.length;i++){
if(j[i].BusStopCode==code){return([j[i].Description,j[i].RoadName])}
else continue;
}
}

function test(){
for (x=0;x<temparray1.length;x++){
htmlx+="<tr><td>"+lookup(temparray1[x])[0]+"</td><td>"+temparray1[x]+"</td><td>"+ lookup(temparray1[x])[1]+"</td></tr>"
}
htmlx+="</table><table class='table'><thead><tr><th>Direction 2</th></tr></thead><tbody>"
for (x=0;x<temparray2.length;x++){
htmlx+="<tr><td>"+lookup(temparray2[x])[0]+"</td><td>"+temparray2[x]+"</td><td>"+ lookup(temparray2[x])[1]+"</td></tr>"
}
htmlx+="</tbody></table></div></div>";

console.log(htmlx);

document.getElementById("stage").innerHTML=htmlx;
x="";

}



getbuses();
getroutes();
test();
</script>


<footer role="contentinfo">
 <div id="footer" class="container">
<center>

 <p>Designed and built by ngxingyu &copy; </p> 
<br>
</center>
 </div>
</footer>

      
      
      
</body>

</html>